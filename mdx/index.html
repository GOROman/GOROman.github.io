<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&family=Orbitron:wght@400;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <link href="style.css" rel="stylesheet">
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <title>WASM MDXPlayer Powered by Claude Code</title>
</head>

<body>
  <div id="mmdsp-container">
    <!-- Header -->
    <header id="mmdsp-header">
      <span class="title">WASM MDXPlayer <span class="subtitle">Powered by Claude Code</span></span>
      <div id="midi-control">
        <span class="midi-label">MIDI IN:</span>
        <select id="midi-input-select">
          <option value="">-- No Device --</option>
        </select>
      </div>
      <span class="version">v0.11</span>
    </header>

    <!-- Main Content -->
    <div id="mmdsp-main">
      <!-- Top Panels: Keyboard + OPM Register -->
      <div id="top-panel">
        <div id="keyboard-panel">
          <div class="panel-header">KEYBOARD (FM1-8 / ADPCM1-8)</div>
          <canvas id="keyboard-canvas" width="500" height="360"></canvas>
        </div>
        <div id="opm-register-panel" class="panel">
          <div class="panel-header">YM2151(OPM) REGISTER</div>
          <canvas id="opm-register-canvas" width="280" height="360"></canvas>
        </div>
      </div>

      <!-- Bottom Panel -->
      <div id="bottom-panel">
        <!-- Control Panel -->
        <div id="control-panel" class="panel">
          <div class="panel-header">CONTROL</div>
          <div class="control-buttons">
            <button id="btn-play" class="ctrl-btn">PLAY</button>
            <button id="btn-pause" class="ctrl-btn">PAUSE</button>
            <button id="btn-stop" class="ctrl-btn">STOP</button>
            <button id="btn-fadeout" class="ctrl-btn">FADE</button>
          </div>
          <div class="control-info">
            <div class="info-row">
              <span class="label">TIME:</span>
              <span id="time-display" class="value">00:00</span>
            </div>
            <div class="info-row">
              <span class="label">LOOP:</span>
              <span id="loop-display" class="value">00</span>
            </div>
            <div class="info-row">
              <span class="label">TEMPO:</span>
              <span id="tempo-display" class="value">000</span>
            </div>
          </div>
        </div>

        <!-- Spectrum Analyzer -->
        <div id="spectrum-panel" class="panel">
          <div class="panel-header">SPECTRUM</div>
          <canvas id="spectrum-canvas" width="280" height="100"></canvas>
        </div>

        <!-- Level Meters -->
        <div id="level-panel" class="panel">
          <div class="panel-header">LEVEL</div>
          <canvas id="level-canvas" width="320" height="120"></canvas>
        </div>
      </div>

      <!-- Playlist Panel -->
      <div id="playlist-panel" class="panel">
        <div class="panel-header">
          <span>PLAYLIST</span>
          <span id="playlist-count">[00/00]</span>
          <div class="playlist-controls">
            <button id="btn-autoplay" class="playlist-btn active" title="Auto Play">AUTO</button>
            <button id="btn-clear-playlist" class="playlist-btn" title="Clear Playlist">CLR</button>
          </div>
        </div>
        <div id="playlist-container" tabindex="0">
          <ul id="playlist-list"></ul>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer id="mmdsp-footer">
      <div id="now-playing">
        <span class="label">NOW PLAYING:</span>
        <span id="title" class="title-text"></span>
      </div>
      <div id="file-info">
        <span>MDX: <span id="mdxfile">-</span></span>
        <span>PDX: <span id="pdxfile">-</span></span>
      </div>
      <div id="drop-zone">
        .MDX / .PDX / .ZIP Drag & Drop
        <input type="file" id="mdxfile1" accept=".mdx,.pdx,.zip" hidden multiple>
      </div>
    </footer>

    <!-- Hidden elements for compatibility -->
    <div id="opmreg" style="display:none;"></div>
    <button id="audio-toggle" style="display:none;">PLAY</button>
    <button id="play-tone" style="display:none;"></button>
    <div id="ddarea" style="display:none;"></div>
  </div>

  <!-- Copyright -->
  <div id="copyright">
    X68k MXDRV music driver version 2.06+17 Rel.X5-S (c)1988-92 milk.,K.MAEKAWA, Missy.M, Yatsube<br>
    <a href="https://gorry.haun.org/mx/">Converted for Win32 [MXDRVg] V2.00a Copyright (C) 2000-2002 GORRY.</a><br>
    X68Sound_src020615 Copyright (C) m_puusan.<br>
    <a href="https://github.com/yosshin4004/portable_mdx">Ported for 64bit environments Copyright (C) 2018 Yosshin.</a><br>
    WASM MDXPlayer 2022-2025 <a href="https://x.com/GOROman">@GOROman</a>.
  </div>

  <script src="index.js" type="module"></script>
</body>

</html>
